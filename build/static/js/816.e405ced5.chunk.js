"use strict";(self.webpackChunkmysite3=self.webpackChunkmysite3||[]).push([[816],{371:()=>{},514:(e,s,a)=>{a.d(s,{LW:()=>u,Oh:()=>n,Qu:()=>m,Rr:()=>o,az:()=>p,jt:()=>r,o2:()=>h,tQ:()=>d,uR:()=>i});var t=a(722),c=a(383);const l="".concat(c.A,"/api/Adminaprovel"),n=()=>t.A.get("".concat(l,"/all")),i=()=>t.A.get("".concat(l,"/pending")),r=e=>t.A.put("".concat(l,"/approve/").concat(e),{}),d=e=>t.A.put("".concat(l,"/reject/").concat(e),{}),o=(e,s)=>t.A.put("".concat(l,"/update/").concat(e),s),u=n,h=e=>t.A.delete("".concat(l,"/delete/").concat(e)),m=r,p=d},816:(e,s,a)=>{a.r(s),a.d(s,{default:()=>i});var t=a(43),c=(a(371),a(514)),l=a(579);const n=function(e){let{user:s,closePopup:a,refresh:n}=e;const[i,r]=(0,t.useState)(s.adminname||""),[d,o]=(0,t.useState)(s.email||""),[u,h]=(0,t.useState)(""),[m,p]=(0,t.useState)(!1),[j,x]=(0,t.useState)("");return(0,l.jsx)("div",{className:"popup-overlay",children:(0,l.jsxs)("div",{className:"popup-card",children:[(0,l.jsx)("h3",{children:"Update User"}),j&&(0,l.jsx)("div",{className:"popup-message ".concat(j.startsWith("\u2705")?"success":"error"),children:j}),(0,l.jsx)("div",{className:"popup-input-group",children:(0,l.jsx)("input",{value:i,onChange:e=>{r(e.target.value),x("")},className:"popup-input",placeholder:"Name *",disabled:m})}),(0,l.jsx)("div",{className:"popup-input-group",children:(0,l.jsx)("input",{value:d,onChange:e=>{o(e.target.value),x("")},className:"popup-input",placeholder:"Email *",disabled:m})}),(0,l.jsx)("div",{className:"popup-input-group",children:(0,l.jsx)("input",{value:u,onChange:e=>{h(e.target.value),x("")},className:"popup-input",placeholder:"New Password (optional)",type:"password",disabled:m})}),(0,l.jsxs)("div",{className:"popup-actions",children:[(0,l.jsx)("button",{onClick:async()=>{if(m)return;const e=i.trim(),t=d.trim(),l=u.trim();if(!e)return void x("\u26a0 Name is required");if(!t)return void x("\u26a0 Email is required");if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t))if(l&&l.length<4)x("\u26a0 Password must be at least 4 characters");else{p(!0),x("");try{const i={adminname:e,email:t};l&&(i.password=l),await(0,c.Rr)(s.customerId,i),x("\u2705 User updated successfully"),n(),setTimeout(()=>{a()},800)}catch(r){console.error("UPDATE ERROR:",null===r||void 0===r?void 0:r.message),x("\u274c Failed to update user")}finally{p(!1)}}else x("\u26a0 Invalid email format")},className:"popup-btn-primary",disabled:m,children:m?(0,l.jsx)("div",{className:"spinner"}):"Update"}),(0,l.jsx)("button",{onClick:a,className:"popup-btn-secondary",disabled:m,children:"Close"})]})]})})};const i=function(){const[e,s]=(0,t.useState)([]),[a,i]=(0,t.useState)(null),[r,d]=(0,t.useState)(!1),[o,u]=(0,t.useState)(""),[h,m]=(0,t.useState)(""),[p,j]=(0,t.useState)(""),[x,v]=(0,t.useState)(""),[b,N]=(0,t.useState)({key:null,direction:"asc"}),[g,y]=(0,t.useState)(1),[f]=(0,t.useState)(10),[k,w]=(0,t.useState)(new Set),[C,S]=(0,t.useState)(!1),[R,A]=(0,t.useState)({total:0,pending:0,approved:0,rejected:0}),E=(0,t.useCallback)(function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";u(e),m(s),setTimeout(()=>{u(""),m("")},5e3)},[]),P=(0,t.useCallback)(async()=>{try{d(!0);const e=await(0,c.LW)(),a=Array.isArray(e.data)?e.data:[];s(a);const t=a.reduce((e,s)=>s?(e.total++,"pending"===s.status||"PENDING"===s.status?e.pending++:"approved"===s.status||"APPROVED"===s.status?e.approved++:"rejected"!==s.status&&"REJECTED"!==s.status||e.rejected++,e):e,{total:0,pending:0,approved:0,rejected:0});A(t)}catch(e){console.error("LOAD USERS ERROR:",null===e||void 0===e?void 0:e.message),E("\u274c Failed to connect to identity server.","error")}finally{d(!1)}},[E]);(0,t.useEffect)(()=>{P()},[P]);const z=(0,t.useCallback)(async e=>{if(!r&&window.confirm("Are you sure you want to delete this user? This action cannot be undone.")){d(!0);try{await(0,c.o2)(e),E("\u2705 User deleted successfully!","success"),await P()}catch(s){console.error("DELETE ERROR:",null===s||void 0===s?void 0:s.message),E("\u274c Failed to delete user. Please try again.","error")}finally{d(!1)}}},[r,E,P]),F=(0,t.useCallback)(async e=>{if(!r){d(!0);try{await(0,c.Qu)(e),E("\u2705 User approved successfully!","success"),await P()}catch(s){console.error("APPROVE ERROR:",null===s||void 0===s?void 0:s.message),E("\u274c Failed to approve user. Please try again.","error")}finally{d(!1)}}},[r,E,P]),U=(0,t.useCallback)(async e=>{if(!r){d(!0);try{await(0,c.az)(e),E("\u26a0\ufe0f User rejected successfully!","warning"),await P()}catch(s){console.error("REJECT ERROR:",null===s||void 0===s?void 0:s.message),E("\u274c Failed to reject user. Please try again.","error")}finally{d(!1)}}},[r,E,P]),I=(0,t.useCallback)(e=>{let s="asc";b.key===e&&"asc"===b.direction&&(s="desc"),N({key:e,direction:s})},[b]),D=(0,t.useMemo)(()=>{let s=e.filter(e=>{var s,a,t;const c=!p||(null===(s=e.adminname)||void 0===s?void 0:s.toLowerCase().includes(p.toLowerCase()))||(null===(a=e.email)||void 0===a?void 0:a.toLowerCase().includes(p.toLowerCase()))||(null===(t=e.customerId)||void 0===t?void 0:t.toString().includes(p)),l=!x||e.status===x;return c&&l});return b.key&&s.sort((e,s)=>{const a=e[b.key]||"",t=s[b.key]||"";return a<t?"asc"===b.direction?-1:1:a>t?"asc"===b.direction?1:-1:0}),s},[e,p,x,b]),L=Math.ceil(D.length/f),O=(0,t.useMemo)(()=>{const e=(g-1)*f;return D.slice(e,e+f)},[D,g,f]),T=(0,t.useCallback)(e=>{if(e){const e=new Set(O.map(e=>e.id));w(e)}else w(new Set)},[O]),M=(0,t.useCallback)((e,s)=>{w(a=>{const t=new Set(a);return s?t.add(e):t.delete(e),t})},[]);(0,t.useEffect)(()=>{S(k.size>0)},[k]);const B=(0,t.useCallback)(async()=>{if(0===k.size)return;const e="Are you sure you want to approve ".concat(k.size," selected user").concat(k.size>1?"s":"","?");if(window.confirm(e)){d(!0);try{const e=Array.from(k).map(e=>(0,c.Qu)(e));await Promise.all(e),E("\u2705 Successfully approved ".concat(k.size," user").concat(k.size>1?"s":"","!"),"success"),w(new Set),await P()}catch(s){console.error("Bulk approve error:",s),E("\u274c Failed to approve some users. Please try again.","error")}finally{d(!1)}}},[k,E,P]),Q=(0,t.useCallback)(async()=>{if(0===k.size)return;const e="Are you sure you want to reject ".concat(k.size," selected user").concat(k.size>1?"s":"","?");if(window.confirm(e)){d(!0);try{const e=Array.from(k).map(e=>(0,c.az)(e));await Promise.all(e),E("\u26a0\ufe0f Successfully rejected ".concat(k.size," user").concat(k.size>1?"s":"","!"),"warning"),w(new Set),await P()}catch(s){console.error("Bulk reject error:",s),E("\u274c Failed to reject some users. Please try again.","error")}finally{d(!1)}}},[k,E,P]),W=(0,t.useCallback)(e=>b.key!==e?"\u2195\ufe0f":"asc"===b.direction?"\u2191":"\u2193",[b]),q=(0,t.useCallback)(e=>{const s={pending:{class:"status-pending",icon:"\u23f3",text:"Pending"},approved:{class:"status-approved",icon:"\u2705",text:"Approved"},rejected:{class:"status-rejected",icon:"\u274c",text:"Rejected"}}[e]||{class:"status-unknown",icon:"\u2753",text:e};return(0,l.jsxs)("span",{className:"status-badge ".concat(s.class),children:[s.icon," ",s.text]})},[]);return(0,l.jsxs)("div",{className:"admin-manage-users",children:[(0,l.jsxs)("div",{className:"header",children:[(0,l.jsx)("h1",{children:"Admin User Management"}),(0,l.jsx)("div",{className:"header-actions",children:(0,l.jsx)("button",{className:"btn btn-secondary",onClick:P,disabled:r,children:r?(0,l.jsx)("div",{className:"spinner"}):"\ud83d\udd04 Refresh"})})]}),(0,l.jsxs)("div",{className:"stats-grid",children:[(0,l.jsxs)("div",{className:"stat-card",children:[(0,l.jsx)("div",{className:"stat-icon",children:"\ud83d\udc65"}),(0,l.jsxs)("div",{className:"stat-content",children:[(0,l.jsx)("div",{className:"stat-number",children:R.total}),(0,l.jsx)("div",{className:"stat-label",children:"Total Users"})]})]}),(0,l.jsxs)("div",{className:"stat-card",children:[(0,l.jsx)("div",{className:"stat-icon",children:"\u23f3"}),(0,l.jsxs)("div",{className:"stat-content",children:[(0,l.jsx)("div",{className:"stat-number",children:R.pending}),(0,l.jsx)("div",{className:"stat-label",children:"Pending"})]})]}),(0,l.jsxs)("div",{className:"stat-card",children:[(0,l.jsx)("div",{className:"stat-icon",children:"\u2705"}),(0,l.jsxs)("div",{className:"stat-content",children:[(0,l.jsx)("div",{className:"stat-number",children:R.approved}),(0,l.jsx)("div",{className:"stat-label",children:"Approved"})]})]}),(0,l.jsxs)("div",{className:"stat-card",children:[(0,l.jsx)("div",{className:"stat-icon",children:"\u274c"}),(0,l.jsxs)("div",{className:"stat-content",children:[(0,l.jsx)("div",{className:"stat-number",children:R.rejected}),(0,l.jsx)("div",{className:"stat-label",children:"Rejected"})]})]})]}),o&&(0,l.jsx)("div",{className:"message message-".concat(h),children:o}),C&&(0,l.jsxs)("div",{className:"bulk-actions-bar",children:[(0,l.jsxs)("div",{className:"bulk-info",children:[(0,l.jsx)("span",{className:"bulk-count",children:k.size}),(0,l.jsx)("span",{className:"bulk-text",children:1===k.size?"user selected":"users selected"})]}),(0,l.jsxs)("div",{className:"bulk-buttons",children:[(0,l.jsx)("button",{className:"btn btn-success",onClick:B,disabled:r,children:"\u2705 Bulk Approve"}),(0,l.jsx)("button",{className:"btn btn-warning",onClick:Q,disabled:r,children:"\u274c Bulk Reject"}),(0,l.jsx)("button",{className:"btn btn-secondary",onClick:()=>w(new Set),disabled:r,children:"\u2716\ufe0f Clear Selection"})]})]}),(0,l.jsx)("div",{className:"search-filter-card",children:(0,l.jsxs)("div",{className:"search-filter-grid",children:[(0,l.jsxs)("div",{className:"search-group",children:[(0,l.jsx)("label",{htmlFor:"search",children:"Search Users"}),(0,l.jsxs)("div",{className:"search-input-wrapper",children:[(0,l.jsx)("input",{id:"search",type:"text",value:p,onChange:e=>j(e.target.value),placeholder:"Search by name, email, or customer ID..."}),(0,l.jsx)("div",{className:"search-icon",children:"\ud83d\udd0d"})]})]}),(0,l.jsxs)("div",{className:"filter-group",children:[(0,l.jsx)("label",{htmlFor:"status-filter",children:"Filter by Status"}),(0,l.jsxs)("select",{id:"status-filter",value:x,onChange:e=>v(e.target.value),children:[(0,l.jsx)("option",{value:"",children:"All Statuses"}),(0,l.jsx)("option",{value:"pending",children:"Pending"}),(0,l.jsx)("option",{value:"approved",children:"Approved"}),(0,l.jsx)("option",{value:"rejected",children:"Rejected"})]})]})]})}),(0,l.jsxs)("div",{className:"table-card",children:[(0,l.jsxs)("div",{className:"table-header",children:[(0,l.jsxs)("h3",{children:["Users (",D.length,")"]}),(0,l.jsx)("div",{className:"table-actions",children:(0,l.jsxs)("span",{className:"results-info",children:["Showing ",O.length," of ",D.length," users"]})})]}),r?(0,l.jsxs)("div",{className:"loading-state",children:[(0,l.jsx)("div",{className:"spinner"}),(0,l.jsx)("span",{children:"Loading users..."})]}):0===D.length?(0,l.jsxs)("div",{className:"empty-state",children:[(0,l.jsx)("div",{className:"empty-icon",children:"\ud83d\udc65"}),(0,l.jsx)("h3",{children:"No users found"}),(0,l.jsx)("p",{children:p||x?"Try adjusting your search or filter criteria":"No users available at the moment"})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"table-wrapper",children:(0,l.jsxs)("table",{className:"users-table",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:(0,l.jsxs)("div",{className:"checkbox-wrapper",children:[(0,l.jsx)("input",{type:"checkbox",id:"select-all",checked:k.size===O.length&&O.length>0,onChange:e=>T(e.target.checked)}),(0,l.jsx)("label",{htmlFor:"select-all",className:"checkbox-label",children:"All"})]})}),(0,l.jsxs)("th",{className:"sortable",onClick:()=>I("id"),children:["ID ",W("id")]}),(0,l.jsxs)("th",{className:"sortable",onClick:()=>I("adminname"),children:["Name ",W("adminname")]}),(0,l.jsxs)("th",{className:"sortable",onClick:()=>I("email"),children:["Email ",W("email")]}),(0,l.jsxs)("th",{className:"sortable",onClick:()=>I("customerId"),children:["Customer ID ",W("customerId")]}),(0,l.jsx)("th",{children:"Password"}),(0,l.jsxs)("th",{className:"sortable",onClick:()=>I("status"),children:["Status ",W("status")]}),(0,l.jsx)("th",{children:"Actions"})]})}),(0,l.jsx)("tbody",{children:O.map(e=>(0,l.jsxs)("tr",{className:k.has(e.id)?"selected-row":"",children:[(0,l.jsx)("td",{children:(0,l.jsxs)("div",{className:"checkbox-wrapper",children:[(0,l.jsx)("input",{type:"checkbox",id:"select-".concat(e.id),checked:k.has(e.id),onChange:s=>M(e.id,s.target.checked)}),(0,l.jsx)("label",{htmlFor:"select-".concat(e.id),className:"checkbox-label"})]})}),(0,l.jsxs)("td",{className:"user-id",children:["#",e.id]}),(0,l.jsx)("td",{className:"user-name",children:e.adminname}),(0,l.jsx)("td",{className:"user-email",children:e.email}),(0,l.jsx)("td",{className:"customer-id",children:e.customerId}),(0,l.jsx)("td",{className:"password-field",children:(0,l.jsx)("span",{className:"password-hidden",children:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"})}),(0,l.jsx)("td",{children:q(e.status)}),(0,l.jsx)("td",{children:(0,l.jsxs)("div",{className:"action-buttons",children:[(0,l.jsx)("button",{className:"btn-icon btn-approve",onClick:()=>F(e.id),title:"Approve user",disabled:r||"approved"===e.status,children:"\u2705"}),(0,l.jsx)("button",{className:"btn-icon btn-reject",onClick:()=>U(e.id),title:"Reject user",disabled:r||"rejected"===e.status,children:"\u274c"}),(0,l.jsx)("button",{className:"btn-icon btn-edit",onClick:()=>i(e),title:"Edit user",disabled:r,children:"\u270f\ufe0f"}),(0,l.jsx)("button",{className:"btn-icon btn-delete",onClick:()=>z(e.customerId),title:"Delete user",disabled:r,children:"\ud83d\uddd1\ufe0f"})]})})]},e.id))})]})}),L>1&&(0,l.jsxs)("div",{className:"pagination",children:[(0,l.jsx)("button",{className:"btn btn-pagination",onClick:()=>y(e=>Math.max(e-1,1)),disabled:1===g,children:"Previous"}),(0,l.jsx)("div",{className:"pagination-info",children:(0,l.jsxs)("span",{children:["Page ",g," of ",L]})}),(0,l.jsx)("button",{className:"btn btn-pagination",onClick:()=>y(e=>Math.min(e+1,L)),disabled:g===L,children:"Next"})]})]})]}),a&&(0,l.jsx)(n,{user:a,closePopup:()=>i(null),refresh:P})]})}}}]);
//# sourceMappingURL=816.e405ced5.chunk.js.map